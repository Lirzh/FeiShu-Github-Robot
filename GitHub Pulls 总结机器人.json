{
  "nodes": [
    {
      "nodeId": "userGuide",
      "name": "common:core.module.template.system_config",
      "intro": "common:core.module.template.system_config_info",
      "avatar": "core/workflow/template/systemConfig",
      "flowNodeType": "userGuide",
      "position": {
        "x": 90,
        "y": -375
      },
      "version": "481",
      "inputs": [
        {
          "key": "welcomeText",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "label": "core.app.Welcome Text",
          "value": ""
        },
        {
          "key": "variables",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "core.app.Chat Variable",
          "value": []
        },
        {
          "key": "questionGuide",
          "valueType": "hidden",
          "renderTypeList": [
            "hidden"
          ],
          "label": "core.app.Question Guide",
          "value": {
            "open": false
          }
        },
        {
          "key": "tts",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": {
            "type": "web"
          }
        },
        {
          "key": "whisper",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": {
            "open": false,
            "autoSend": false,
            "autoTTSResponse": false
          }
        },
        {
          "key": "scheduleTrigger",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": null
        }
      ],
      "outputs": []
    },
    {
      "nodeId": "448745",
      "name": "common:core.module.template.work_start",
      "intro": "",
      "avatar": "core/workflow/template/workflowStart",
      "flowNodeType": "workflowStart",
      "position": {
        "x": 632.368838596004,
        "y": -347.7446492944009
      },
      "version": "481",
      "inputs": [
        {
          "key": "userChatInput",
          "renderTypeList": [
            "reference",
            "textarea"
          ],
          "valueType": "string",
          "label": "workflow:user_question",
          "required": true,
          "toolDescription": "用户问题",
          "debugLabel": ""
        }
      ],
      "outputs": [
        {
          "id": "userChatInput",
          "key": "userChatInput",
          "label": "common:core.module.input.label.user question",
          "type": "static",
          "valueType": "string",
          "description": ""
        }
      ]
    },
    {
      "nodeId": "jVGuKrDfFTU6",
      "name": "获取 72 小时前的日期",
      "intro": "执行一段简单的脚本代码，通常用于进行复杂的数据处理。",
      "avatar": "core/workflow/template/codeRun",
      "flowNodeType": "code",
      "showStatus": true,
      "position": {
        "x": 1045.4174257570808,
        "y": -94.5419824521446
      },
      "version": "482",
      "inputs": [
        {
          "key": "system_addInputParam",
          "renderTypeList": [
            "addInputParam"
          ],
          "valueType": "dynamic",
          "label": "",
          "required": false,
          "description": "workflow:these_variables_will_be_input_parameters_for_code_execution",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "codeType",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "value": "js",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        },
        {
          "key": "code",
          "renderTypeList": [
            "custom"
          ],
          "label": "",
          "value": "function main() {\n  const date = new Date();\n  date.setDate(date.getDate() - 3);\n  const day = date.getDate();\n  const month = date.getMonth() + 1;\n  const year = date.getFullYear();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n\n  return {\n    date: `${year}-${month}-${day}T${hours}:${minutes}:000Z`,\n  }\n }",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        }
      ],
      "outputs": [
        {
          "id": "system_rawResponse",
          "key": "system_rawResponse",
          "label": "workflow:full_response_data",
          "valueType": "object",
          "type": "static",
          "description": ""
        },
        {
          "id": "error",
          "key": "error",
          "label": "workflow:error_text",
          "description": "代码运行错误信息，成功时返回空",
          "valueType": "string",
          "type": "error"
        },
        {
          "id": "system_addOutputParam",
          "key": "system_addOutputParam",
          "type": "dynamic",
          "valueType": "dynamic",
          "label": "",
          "customFieldConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectApp",
              "selectDataset"
            ],
            "showDescription": false,
            "showDefaultValue": false
          },
          "description": "将代码中 return 的对象作为输出，传递给后续的节点。变量名需要对应 return 的 key",
          "valueDesc": ""
        },
        {
          "id": "gR0mkQpJ4Og8",
          "type": "dynamic",
          "key": "date",
          "valueType": "string",
          "label": "date",
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": true
    },
    {
      "nodeId": "jyftFRrd4RQf",
      "name": "指定回复",
      "intro": "该模块可以直接回复一段指定的内容。常用于引导、提示。非字符串内容传入时，会转成字符串进行输出。",
      "avatar": "core/workflow/template/reply",
      "flowNodeType": "answerNode",
      "position": {
        "x": 1758.8251385440858,
        "y": 80.55020745654087
      },
      "version": "481",
      "inputs": [
        {
          "key": "text",
          "renderTypeList": [
            "textarea",
            "reference"
          ],
          "valueType": "any",
          "required": true,
          "label": "common:core.module.input.label.Response content",
          "description": "common:core.module.input.description.Response content",
          "placeholder": "common:core.module.input.description.Response content",
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": "",
          "value": "拉取从 {{$jVGuKrDfFTU6.gR0mkQpJ4Og8$}} 以来所有的 open pull \\n",
          "isRichText": false,
          "maxLength": 100000
        }
      ],
      "outputs": []
    },
    {
      "nodeId": "mCaalLpFoZFk",
      "name": "获取 Issues",
      "intro": "可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）",
      "avatar": "core/workflow/template/httpRequest",
      "flowNodeType": "httpRequest468",
      "showStatus": true,
      "position": {
        "x": 2602.5615507147536,
        "y": -67.18952984768578
      },
      "version": "481",
      "inputs": [
        {
          "key": "system_addInputParam",
          "renderTypeList": [
            "addInputParam"
          ],
          "valueType": "dynamic",
          "label": "",
          "required": false,
          "description": "common:core.module.input.description.HTTP Dynamic Input",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": "",
          "deprecated": false
        },
        {
          "key": "system_httpMethod",
          "renderTypeList": [
            "custom"
          ],
          "valueType": "string",
          "label": "",
          "value": "GET",
          "required": true,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpTimeout",
          "renderTypeList": [
            "custom"
          ],
          "valueType": "number",
          "label": "",
          "value": 30,
          "min": 5,
          "max": 600,
          "required": true,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpReqUrl",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "label": "",
          "description": "common:core.module.input.description.Http Request Url",
          "placeholder": "https://api.ai.com/getInventory",
          "required": false,
          "value": "https://api.github.com/repos/用户名/仓库名/pulls",
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_header_secret",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "object",
          "label": "",
          "required": false,
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpHeader",
          "renderTypeList": [
            "custom"
          ],
          "valueType": "any",
          "value": [],
          "label": "",
          "description": "common:core.module.input.description.Http Request Header",
          "placeholder": "common:core.module.input.description.Http Request Header",
          "required": false,
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpParams",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "value": [
            {
              "key": "state",
              "type": "string",
              "value": "open"
            },
            {
              "key": "since",
              "type": "string",
              "value": "{{$jVGuKrDfFTU6.gR0mkQpJ4Og8$}}"
            }
          ],
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpJsonBody",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "value": "",
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpFormBody",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "value": [],
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpContentType",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "value": "json",
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": [
        {
          "id": "httpRawResponse",
          "key": "httpRawResponse",
          "required": true,
          "label": "workflow:raw_response",
          "description": "HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。",
          "valueType": "any",
          "type": "static"
        },
        {
          "id": "error",
          "key": "error",
          "label": "workflow:error_text",
          "description": "HTTP请求错误信息，成功时返回空",
          "valueType": "string",https://open.feishu.cn/open-apis/bot/v2/hook/c7361a3b-55ef-4d08-a675-08e0787182bf
          "type": "error"
        },
        {
          "id": "system_addOutputParam",
          "key": "system_addOutputParam",
          "type": "dynamic",
          "valueType": "dynamic",
          "label": "",
          "customFieldConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectApp",
              "selectDataset"
            ],
            "showDescription": false,
            "showDefaultValue": false
          },
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": true
    },
    {
      "nodeId": "gALvyJcXPoep",
      "name": "处理 API 响应数据",
      "intro": "执行一段简单的脚本代码，通常用于进行复杂的数据处理。",
      "avatar": "core/workflow/template/codeRun",
      "flowNodeType": "code",
      "showStatus": true,
      "position": {
        "x": 3396.722564475613,
        "y": -80.79235153344955
      },
      "version": "482",
      "inputs": [
        {
          "key": "system_addInputParam",
          "renderTypeList": [
            "addInputParam"
          ],
          "valueType": "dynamic",
          "label": "",
          "required": false,
          "description": "workflow:these_variables_will_be_input_parameters_for_code_execution",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "codeType",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "value": "js",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        },
        {
          "key": "code",
          "renderTypeList": [
            "custom"
          ],
          "label": "",
          "value": "function main(params) {\n  let pulls = [];\n  if (params?.res && typeof params.res === \"string\") {\n    try {\n      pulls = JSON.parse(params.res); // 解析res里的JSON字符串为数组\n    } catch (e) {\n      pulls = []; // 解析失败（格式错误）则置空\n    }\n  }\n  // 最终容错：确保是数组，非数组则置空\n  pulls = Array.isArray(pulls) ? pulls : [];\n\n  // 初始化文本片段数组\n  const textFragments = [\"Pulls 检查\\n\\n项目 Pull Request 汇总：\\n\\n\"];\n\n  // 遍历所有PR，提取核心信息\n  pulls.forEach((pull, index) => {\n    if (!pull || typeof pull !== \"object\") return;\n\n    // 提取GitHub PR核心字段+兜底\n    const prNumber = pull.number || \"未知编号\";\n    const title = pull.title?.trim() || \"无标题\";\n    const htmlUrl = pull.html_url || pull.url || \"无链接\";\n    const author = pull.user?.login || \"未知作者\";\n    const state = pull.state?.toUpperCase() || \"未知状态\";\n    const isDraft = pull.draft ? \"[草稿]\" : \"\";\n    const authorRole = pull.author_association || \"普通贡献者\";\n\n    // 处理修改描述：统一换行符、兜底\n    let body = (pull.body || \"\").replace(/\\r\\n|\\r|\\n/g, \"\\n\").trim();\n    body = body || \"无修改描述\";\n\n    // 处理创建时间：UTC转本地格式（YYYY-MM-DD HH:mm）\n    let createTime = \"未知创建时间\";\n    if (pull.created_at) {\n      createTime = new Date(pull.created_at).toLocaleString('zh-CN', {\n        year: 'numeric',\n        month: '2-digit',\n        day: '2-digit',\n        hour: '2-digit',\n        minute: '2-digit',\n        hour12: false\n      });\n    }\n\n    // 拼接单条PR信息\n    textFragments.push(\n      `${index + 1}. PR#${prNumber} [${state}] ${isDraft}【${title}】`,\n      `📝 提交者：${author}（${authorRole}）`,\n      `🕒 创建时间：${createTime}`,\n      `🔗 链接：${htmlUrl}`,\n      `💻 修改内容：\\n${body}`,\n      \"\\n\\n\"\n    );\n  });\n\n  // 兜底处理：无有效PR时替换文本\n  let sendText = textFragments.join(\"\\n\");\n  const emptyFlag = \"项目 Pull Request 汇总：\\n\\n\";\n  if (sendText === emptyFlag) {\n    sendText = \"项目暂无有效 Pull Request 数据\";\n  }\n\n  return {\n    ret: sendText\n  };\n}\n",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        },
        {
          "renderTypeList": [
            "reference"
          ],
          "valueType": "string",
          "canEdit": true,
          "key": "res",
          "label": "res",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "required": true,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "value": [
            "mCaalLpFoZFk",
            "httpRawResponse"
          ]
        }
      ],
      "outputs": [
        {
          "id": "system_rawResponse",
          "key": "system_rawResponse",
          "label": "workflow:full_response_data",
          "valueType": "object",
          "type": "static",
          "description": ""
        },
        {
          "id": "error",
          "key": "error",
          "label": "workflow:error_text",
          "description": "代码运行错误信息，成功时返回空",
          "valueType": "string",
          "type": "error"
        },
        {
          "id": "system_addOutputParam",
          "key": "system_addOutputParam",
          "type": "dynamic",
          "valueType": "dynamic",
          "label": "",
          "customFieldConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectApp",
              "selectDataset"
            ],
            "showDescription": false,
            "showDefaultValue": false
          },
          "description": "将代码中 return 的对象作为输出，传递给后续的节点。变量名需要对应 return 的 key",
          "valueDesc": ""
        },
        {
          "id": "qLUQfhG0ILRX",
          "type": "dynamic",
          "key": "ret",
          "valueType": "string",
          "label": "ret",
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": true
    },
    {
      "nodeId": "jmSiT6OXA3Fe",
      "name": "飞书机器人 webhook",
      "intro": "向飞书机器人发起 webhook 请求。",
      "avatar": "/appMarketTemplates/plugin-feishu/avatar.svg",
      "flowNodeType": "pluginModule",
      "showStatus": false,
      "position": {
        "x": 4245,
        "y": 120
      },
      "version": "0.1.1",
      "inputs": [
        {
          "key": "system_forbid_stream",
          "renderTypeList": [
            "switch"
          ],
          "valueType": "boolean",
          "label": "禁用流输出",
          "description": "强制设置嵌套运行的应用，均以非流模式运行",
          "value": true,
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "renderTypeList": [
            "reference"
          ],
          "selectedTypeIndex": 0,
          "valueType": "string",
          "canEdit": false,
          "key": "content",
          "label": "content",
          "description": "需要发送的消息",
          "required": true,
          "toolDescription": "需要发送的消息",
          "value": [
            "gALvyJcXPoep",
            "qLUQfhG0ILRX"
          ],
          "valueDesc": "",
          "debugLabel": ""
        },
        {
          "renderTypeList": [
            "input"
          ],
          "selectedTypeIndex": 0,
          "valueType": "string",
          "canEdit": false,
          "key": "hook_url",
          "label": "hook_url",
          "description": "飞书机器人地址",
          "required": true,
          "defaultValue": "",
          "value": "你的 webhook 地址",
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": [
        {
          "id": "result",
          "type": "static",
          "key": "result",
          "valueType": "object",
          "label": "result",
          "description": "",
          "valueDesc": ""
        }
      ],
      "pluginId": "community-feishu",
      "toolConfig": {
        "systemTool": {
          "toolId": "systemTool-feishu"
        }
      },
      "catchError": false
    }
  ],
  "edges": [
    {
      "source": "448745",
      "target": "jVGuKrDfFTU6",
      "sourceHandle": "448745-source-right",
      "targetHandle": "jVGuKrDfFTU6-target-left"
    },
    {
      "source": "jVGuKrDfFTU6",
      "target": "jyftFRrd4RQf",
      "sourceHandle": "jVGuKrDfFTU6-source-right",
      "targetHandle": "jyftFRrd4RQf-target-left"
    },
    {
      "source": "jyftFRrd4RQf",
      "target": "mCaalLpFoZFk",
      "sourceHandle": "jyftFRrd4RQf-source-right",
      "targetHandle": "mCaalLpFoZFk-target-left"
    },
    {
      "source": "mCaalLpFoZFk",
      "target": "gALvyJcXPoep",
      "sourceHandle": "mCaalLpFoZFk-source-right",
      "targetHandle": "gALvyJcXPoep-target-left"
    },
    {
      "source": "jVGuKrDfFTU6",
      "target": "jyftFRrd4RQf",
      "sourceHandle": "jVGuKrDfFTU6-source_catch-right",
      "targetHandle": "jyftFRrd4RQf-target-left"
    },
    {
      "source": "mCaalLpFoZFk",
      "target": "gALvyJcXPoep",
      "sourceHandle": "mCaalLpFoZFk-source_catch-right",
      "targetHandle": "gALvyJcXPoep-target-left"
    },
    {
      "source": "gALvyJcXPoep",
      "target": "jmSiT6OXA3Fe",
      "sourceHandle": "gALvyJcXPoep-source-right",
      "targetHandle": "jmSiT6OXA3Fe-target-left"
    }
  ],
  "chatConfig": {
    "variables": [],
    "scheduledTriggerConfig": {
      "cronString": "0 8 * * *",
      "timezone": "Asia/Shanghai",
      "defaultPrompt": "go"
    },
    "_id": "67152011bb78889107c3a4ec"
  }
}