{
  "nodes": [
    {
      "nodeId": "userGuide",
      "name": "common:core.module.template.system_config",
      "intro": "common:core.module.template.system_config_info",
      "avatar": "core/workflow/template/systemConfig",
      "flowNodeType": "userGuide",
      "position": {
        "x": 120,
        "y": -435
      },
      "version": "481",
      "inputs": [
        {
          "key": "welcomeText",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "label": "core.app.Welcome Text",
          "value": ""
        },
        {
          "key": "variables",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "core.app.Chat Variable",
          "value": []
        },
        {
          "key": "questionGuide",
          "valueType": "hidden",
          "renderTypeList": [
            "hidden"
          ],
          "label": "core.app.Question Guide",
          "value": {
            "open": false
          }
        },
        {
          "key": "tts",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": {
            "type": "web"
          }
        },
        {
          "key": "whisper",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": {
            "open": false,
            "autoSend": false,
            "autoTTSResponse": false
          }
        },
        {
          "key": "scheduleTrigger",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": null
        }
      ],
      "outputs": [],
      "isFolded": false
    },
    {
      "nodeId": "448745",
      "name": "common:core.module.template.work_start",
      "intro": "",
      "avatar": "core/workflow/template/workflowStart",
      "flowNodeType": "workflowStart",
      "position": {
        "x": 632.368838596004,
        "y": -347.7446492944009
      },
      "version": "481",
      "inputs": [
        {
          "key": "userChatInput",
          "renderTypeList": [
            "reference",
            "textarea"
          ],
          "valueType": "string",
          "label": "workflow:user_question",
          "required": true,
          "toolDescription": "用户问题",
          "debugLabel": ""
        }
      ],
      "outputs": [
        {
          "id": "userChatInput",
          "key": "userChatInput",
          "label": "common:core.module.input.label.user question",
          "type": "static",
          "valueType": "string",
          "description": ""
        }
      ]
    },
    {
      "nodeId": "jVGuKrDfFTU6",
      "name": "获取 72 小时前的日期",
      "intro": "执行一段简单的脚本代码，通常用于进行复杂的数据处理。",
      "avatar": "core/workflow/template/codeRun",
      "flowNodeType": "code",
      "showStatus": true,
      "position": {
        "x": 1050,
        "y": -82.7923515334495
      },
      "version": "482",
      "inputs": [
        {
          "key": "system_addInputParam",
          "renderTypeList": [
            "addInputParam"
          ],
          "valueType": "dynamic",
          "label": "",
          "required": false,
          "description": "workflow:these_variables_will_be_input_parameters_for_code_execution",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "codeType",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "value": "js",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        },
        {
          "key": "code",
          "renderTypeList": [
            "custom"
          ],
          "label": "",
          "value": "function main() {\n  const date = new Date();\n  date.setDate(date.getDate() - 3);\n  const day = date.getDate();\n  const month = date.getMonth() + 1;\n  const year = date.getFullYear();\n  const hours = date.getHours();\n  const minutes = date.getMinutes();\n\n  return {\n    date: `${year}-${month}-${day}T${hours}:${minutes}:000Z`,\n  }\n }",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        }
      ],
      "outputs": [
        {
          "id": "system_rawResponse",
          "key": "system_rawResponse",
          "label": "workflow:full_response_data",
          "valueType": "object",
          "type": "static",
          "description": ""
        },
        {
          "id": "error",
          "key": "error",
          "label": "workflow:error_text",
          "description": "代码运行错误信息，成功时返回空",
          "valueType": "string",
          "type": "error"
        },
        {
          "id": "system_addOutputParam",
          "key": "system_addOutputParam",
          "type": "dynamic",
          "valueType": "dynamic",
          "label": "",
          "customFieldConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectApp",
              "selectDataset"
            ],
            "showDescription": false,
            "showDefaultValue": false
          },
          "description": "将代码中 return 的对象作为输出，传递给后续的节点。变量名需要对应 return 的 key",
          "valueDesc": ""
        },
        {
          "id": "gR0mkQpJ4Og8",
          "type": "dynamic",
          "key": "date",
          "valueType": "string",
          "label": "date",
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": true
    },
    {
      "nodeId": "jyftFRrd4RQf",
      "name": "指定回复",
      "intro": "该模块可以直接回复一段指定的内容。常用于引导、提示。非字符串内容传入时，会转成字符串进行输出。",
      "avatar": "core/workflow/template/reply",
      "flowNodeType": "answerNode",
      "position": {
        "x": 1755,
        "y": 75
      },
      "version": "481",
      "inputs": [
        {
          "key": "text",
          "renderTypeList": [
            "textarea",
            "reference"
          ],
          "valueType": "any",
          "required": true,
          "label": "common:core.module.input.label.Response content",
          "description": "common:core.module.input.description.Response content",
          "placeholder": "common:core.module.input.description.Response content",
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": "",
          "value": "拉取从 {{$jVGuKrDfFTU6.gR0mkQpJ4Og8$}} 以来所有的 open issue \\n",
          "isRichText": false,
          "maxLength": 100000
        }
      ],
      "outputs": []
    },
    {
      "nodeId": "mCaalLpFoZFk",
      "name": "获取 Issues",
      "intro": "可以发出一个 HTTP 请求，实现更为复杂的操作（联网搜索、数据库查询等）",
      "avatar": "core/workflow/template/httpRequest",
      "flowNodeType": "httpRequest468",
      "showStatus": true,
      "position": {
        "x": 2550,
        "y": -135
      },
      "version": "481",
      "inputs": [
        {
          "key": "system_addInputParam",
          "renderTypeList": [
            "addInputParam"
          ],
          "valueType": "dynamic",
          "label": "",
          "required": false,
          "description": "common:core.module.input.description.HTTP Dynamic Input",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": "",
          "deprecated": false
        },
        {
          "key": "system_httpMethod",
          "renderTypeList": [
            "custom"
          ],
          "valueType": "string",
          "label": "",
          "value": "GET",
          "required": true,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpTimeout",
          "renderTypeList": [
            "custom"
          ],
          "valueType": "number",
          "label": "",
          "value": 30,
          "min": 5,
          "max": 600,
          "required": true,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpReqUrl",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "label": "",
          "description": "common:core.module.input.description.Http Request Url",
          "placeholder": "https://api.ai.com/getInventory",
          "required": false,
          "value": "https://api.github.com/repos/用户名/仓库名/issues",
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_header_secret",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "object",
          "label": "",
          "required": false,
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpHeader",
          "renderTypeList": [
            "custom"
          ],
          "valueType": "any",
          "value": [],
          "label": "",
          "description": "common:core.module.input.description.Http Request Header",
          "placeholder": "common:core.module.input.description.Http Request Header",
          "required": false,
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpParams",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "value": [
            {
              "key": "state",
              "type": "string",
              "value": "open"
            },
            {
              "key": "since",
              "type": "string",
              "value": "{{$jVGuKrDfFTU6.gR0mkQpJ4Og8$}}"
            }
          ],
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpJsonBody",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "value": "",
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpFormBody",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "value": [],
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "system_httpContentType",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "value": "json",
          "label": "",
          "required": false,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": [
        {
          "id": "httpRawResponse",
          "key": "httpRawResponse",
          "required": true,
          "label": "workflow:raw_response",
          "description": "HTTP请求的原始响应。只能接受字符串或JSON类型响应数据。",
          "valueType": "any",
          "type": "static"
        },
        {
          "id": "error",
          "key": "error",
          "label": "workflow:error_text",
          "description": "HTTP请求错误信息，成功时返回空",
          "valueType": "string",
          "type": "error"
        },
        {
          "id": "system_addOutputParam",
          "key": "system_addOutputParam",
          "type": "dynamic",
          "valueType": "dynamic",
          "label": "",
          "customFieldConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectApp",
              "selectDataset"
            ],
            "showDescription": false,
            "showDefaultValue": false
          },
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": true
    },
    {
      "nodeId": "gALvyJcXPoep",
      "name": "处理 API 响应数据",
      "intro": "执行一段简单的脚本代码，通常用于进行复杂的数据处理。",
      "avatar": "core/workflow/template/codeRun",
      "flowNodeType": "code",
      "showStatus": true,
      "position": {
        "x": 3420,
        "y": -67.5
      },
      "version": "482",
      "inputs": [
        {
          "key": "system_addInputParam",
          "renderTypeList": [
            "addInputParam"
          ],
          "valueType": "dynamic",
          "label": "",
          "required": false,
          "description": "workflow:these_variables_will_be_input_parameters_for_code_execution",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "valueDesc": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "codeType",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "value": "js",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        },
        {
          "key": "code",
          "renderTypeList": [
            "custom"
          ],
          "label": "",
          "value": "function main(params) {\n const issues = params?.res && Array.isArray(params.res) ? params.res : [];\n  // 初始化可直接发送的汇总文本\n  let sendText = \"Issue 检查\\n\\n项目最近三天内的有效Issue汇总：\\n\\n\";\n\n  // 遍历所有数据，过滤PR只保留有效Issue\n  for (const issue of issues) {\n    // 跳过PR、空数据，只处理纯Issue\n    if (!issue || issue.pull_request) continue;\n\n    // 1. 提取标签：多标签用「、」连接，无标签显示「无」\n    const labels = issue.labels?.map(lab => lab.name).join(\"、\") || \"无\";\n    // 2. 格式化时间：ISO时间转「2026/1/27」中文友好格式，无时间显示「无提交时间」\n    const createTime = issue.created_at \n      ? new Date(issue.created_at).toLocaleDateString() \n      : \"无提交时间\";\n    // 3. 精准提取「功能概述/问题描述」+ 保留原始换行（语句间自动分行）\n    let desc = \"无相关描述\";\n    if (issue.body) {\n      // 正则匹配：匹配标题到下一个###标题/文本末尾，包含所有换行\n      const featureReg = /### 功能概述[\\s\\S]*?(?=### |$)/; // 匹配Feature的功能概述\n      const bugReg = /### 问题描述[\\s\\S]*?(?=### |$)/;     // 匹配Bug的问题描述\n      const featureMatch = issue.body.match(featureReg);\n      const bugMatch = issue.body.match(bugReg);\n\n      if (featureMatch) {\n        // 去掉标题、清理首尾空格，保留原始换行让语句分行\n        desc = featureMatch[0].replace(\"### 功能概述\", \"\").trim() || \"功能概述无具体内容\";\n      } else if (bugMatch) {\n        // 同上处理问题描述\n        desc = bugMatch[0].replace(\"### 问题描述\", \"\").trim() || \"问题描述无具体内容\";\n      }\n    }\n\n    // 4. 拼接文本，排版清晰，适配直接发送\n    sendText += `【#${issue.number}】${issue.title}\\n`;\n    sendText += `链接：${issue.html_url || \"无链接\"}\\n`;\n    sendText += `状态：${issue.state === \"open\" ? \"未解决\" : \"已关闭\"} | 标签：${labels}\\n`;\n    sendText += `提交人：${issue.user?.login || \"匿名\"} | 提交时间：${createTime}\\n`;\n    sendText += `描述：\\n\\n${desc}\\n\\n`; // 描述单独一行，语句自动换行\n    sendText += \"————————————————————\\n\\n\"; // 分隔线区分每个Issue，更整洁\n  }\n\n  // 兜底处理：确实无有效Issue时，显示友好提示\n  if (sendText === \"项目有效Issue汇总（已过滤PR）：\\n\\n\") {\n    sendText = \"项目暂无有效Issue（全部为PR或无数据）\";\n  }\n\n return {\n    ret: sendText,\n    完整响应数据: params\n  };\n}\n",
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "valueType": "string"
        },
        {
          "renderTypeList": [
            "reference"
          ],
          "valueType": "any",
          "canEdit": true,
          "key": "res",
          "label": "res",
          "customInputConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectDataset",
              "selectApp"
            ],
            "showDescription": false,
            "showDefaultValue": true
          },
          "required": true,
          "valueDesc": "",
          "description": "",
          "debugLabel": "",
          "toolDescription": "",
          "value": [
            "mCaalLpFoZFk",
            "httpRawResponse"
          ]
        }
      ],
      "outputs": [
        {
          "id": "system_rawResponse",
          "key": "system_rawResponse",
          "label": "workflow:full_response_data",
          "valueType": "object",
          "type": "static",
          "description": ""
        },
        {
          "id": "error",
          "key": "error",
          "label": "workflow:error_text",
          "description": "代码运行错误信息，成功时返回空",
          "valueType": "string",
          "type": "error"
        },
        {
          "id": "system_addOutputParam",
          "key": "system_addOutputParam",
          "type": "dynamic",
          "valueType": "dynamic",
          "label": "",
          "customFieldConfig": {
            "selectValueTypeList": [
              "string",
              "number",
              "boolean",
              "object",
              "arrayString",
              "arrayNumber",
              "arrayBoolean",
              "arrayObject",
              "arrayAny",
              "any",
              "chatHistory",
              "datasetQuote",
              "dynamic",
              "selectApp",
              "selectDataset"
            ],
            "showDescription": false,
            "showDefaultValue": false
          },
          "description": "将代码中 return 的对象作为输出，传递给后续的节点。变量名需要对应 return 的 key",
          "valueDesc": ""
        },
        {
          "id": "qLUQfhG0ILRX",
          "type": "dynamic",
          "key": "ret",
          "valueType": "string",
          "label": "ret",
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": true
    },
    {
      "nodeId": "nizxOvmz7pk6ha8u",
      "name": "飞书 webhook 插件",
      "intro": "",
      "avatar": "/api/system/img/avatar/697af71bedf8a06965976ef3/hOvBH0-飞书_qW1Pxf.png",
      "flowNodeType": "pluginModule",
      "showStatus": true,
      "position": {
        "x": 4320,
        "y": 158
      },
      "version": "697b1e254b73e2efd0cd9ef5",
      "inputs": [
        {
          "key": "system_forbid_stream",
          "renderTypeList": [
            "switch"
          ],
          "valueType": "boolean",
          "label": "workflow:template.forbid_stream",
          "description": "workflow:template.forbid_stream_desc",
          "value": true
        },
        {
          "inputType": "input",
          "valueType": "string",
          "key": "飞书机器人地址",
          "label": "飞书机器人地址",
          "description": "",
          "isToolInput": false,
          "defaultValue": "",
          "editField": {
            "key": true
          },
          "dynamicParamDefaultValue": {
            "inputType": "reference",
            "valueType": "string",
            "required": true
          },
          "renderTypeList": [
            "input"
          ],
          "required": true,
          "canEdit": false,
          "value": "你的 webhook 地址"
        },
        {
          "key": "发送的消息",
          "valueType": "string",
          "label": "发送的消息",
          "renderTypeList": [
            "reference"
          ],
          "required": true,
          "description": "",
          "canEdit": false,
          "value": [
            "gALvyJcXPoep",
            "qLUQfhG0ILRX"
          ],
          "editField": {
            "key": true
          },
          "dynamicParamDefaultValue": {
            "inputType": "reference",
            "valueType": "string",
            "required": true
          }
        }
      ],
      "outputs": [
        {
          "id": "system_error_text",
          "key": "system_error_text",
          "type": "error",
          "valueType": "string",
          "label": "workflow:error_text"
        }
      ],
      "pluginId": "697b1e254b73e2efd0cd9ef3",
      "catchError": false
    }
  ],
  "edges": [
    {
      "source": "448745",
      "target": "jVGuKrDfFTU6",
      "sourceHandle": "448745-source-right",
      "targetHandle": "jVGuKrDfFTU6-target-left"
    },
    {
      "source": "jVGuKrDfFTU6",
      "target": "jyftFRrd4RQf",
      "sourceHandle": "jVGuKrDfFTU6-source-right",
      "targetHandle": "jyftFRrd4RQf-target-left"
    },
    {
      "source": "jyftFRrd4RQf",
      "target": "mCaalLpFoZFk",
      "sourceHandle": "jyftFRrd4RQf-source-right",
      "targetHandle": "mCaalLpFoZFk-target-left"
    },
    {
      "source": "mCaalLpFoZFk",
      "target": "gALvyJcXPoep",
      "sourceHandle": "mCaalLpFoZFk-source-right",
      "targetHandle": "gALvyJcXPoep-target-left"
    },
    {
      "source": "jVGuKrDfFTU6",
      "target": "jyftFRrd4RQf",
      "sourceHandle": "jVGuKrDfFTU6-source_catch-right",
      "targetHandle": "jyftFRrd4RQf-target-left"
    },
    {
      "source": "mCaalLpFoZFk",
      "target": "gALvyJcXPoep",
      "sourceHandle": "mCaalLpFoZFk-source_catch-right",
      "targetHandle": "gALvyJcXPoep-target-left"
    },
    {
      "source": "gALvyJcXPoep",
      "target": "nizxOvmz7pk6ha8u",
      "sourceHandle": "gALvyJcXPoep-source-right",
      "targetHandle": "nizxOvmz7pk6ha8u-target-left"
    }
  ],
  "chatConfig": {
    "welcomeText": "go",
    "variables": [],
    "scheduledTriggerConfig": {
      "cronString": "0 8 * * *",
      "timezone": "Asia/Shanghai",
      "defaultPrompt": "go"
    },
    "autoExecute": {
      "open": false,
      "defaultPrompt": "go\n"
    },
    "_id": "67152011bb78889107c3a4ec"
  }
}